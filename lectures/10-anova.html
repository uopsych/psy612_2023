<!DOCTYPE html>
<html lang="en"><head>
<script src="10-anova_files/libs/clipboard/clipboard.min.js"></script>
<script src="10-anova_files/libs/quarto-html/tabby.min.js"></script>
<script src="10-anova_files/libs/quarto-html/popper.min.js"></script>
<script src="10-anova_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="10-anova_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="10-anova_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="10-anova_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <title>ANOVA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="10-anova_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="10-anova_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="10-anova_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="10-anova_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="10-anova_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="10-anova_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="10-anova_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="10-anova_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="10-anova_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">ANOVA</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2">

<div class="cell">

</div>
</section>
<section id="last-time" class="slide level2">
<h2>Last time</h2>
<ul>
<li class="fragment">Regression with categorical predictors</li>
</ul>
<h3 id="today">Today…</h3>
<ul>
<li class="fragment">ANOVA</li>
</ul>
<p>But these are the same model! So why two versions?</p>
</section>
<section class="slide level2">

<p>Mathematically, regression with dummy codes and ANOVA are identical. But the way information is presented is different. Different frameworks are useful for different research designs and questions.</p>
<ul>
<li class="fragment"><p>If you only have unordered, categorical variables, ANOVA may be easier to interpret.</p></li>
<li class="fragment"><p>If you have a mix of categorical and continuous variables, regression may be easier.</p></li>
<li class="fragment"><p>You don’t really need to choose…</p></li>
</ul>
</section>
<section class="slide level2">

</section>
<section>
<section id="testing-group-differences-in-the-anova-framework" class="title-slide slide level1 center">
<h1>Testing group differences in the ANOVA framework</h1>

</section>
<section class="slide level2">

<h3 id="hypothesis">Hypothesis</h3>
<p>Unlike regression, the ANOVA framework has a single hypothesis test. This is equivalent to the omnibus test of a multiple regression model.</p>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="regression">Regression</h3>
<p><span class="math display">\[H_0: \rho^2_{Y\hat{Y}} = 0\]</span> <span class="math display">\[H_1: \rho^2_{Y\hat{Y}} &gt; 0\]</span></p>
</div><div class="column" style="width:50%;">
<h3 id="anova">ANOVA</h3>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 = \mu_3 = \mu_4\]</span> <span class="math display">\[H_1: \text{Not that } \mu_1 = \mu_2 = \mu_3 = \mu_4\]</span> This can occur in quite a number of ways.</p>
</div>
</div>
</section>
<section class="slide level2">

<p>The total variability of all of the data, regardless of group membership, can be expressed as:</p>
<p><span class="math display">\[\large Var(Y) = \frac{1}{N}\sum_{k=1}^G\sum_{i=1}^{N_k}(Y_{ik}-\bar{Y})^2\]</span></p>
<p>for G groups and <span class="math inline">\(N_k\)</span> participants within groups.</p>
</section>
<section class="slide level2">

<p>In analysis of variance, we will be interested in the numerator of this variance equation, known as the total sum of squares<sup>1</sup>:</p>
<p><span class="math display">\[\large SS_{tot} = \sum_{k=1}^G\sum_{i=1}^{N_k}(Y_{ik}-\bar{Y})^2\]</span></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>It’s worth noting that this is just a more complicated way of expressing <span class="math inline">\(SS_Y\)</span>, which we’ve been using all term, but in a way that will be useful for thinking about how we partition sums of squares later.</p></li></ol></aside></section>
<section class="slide level2">

<p>We already know from regression that the deviation of a score from the grand mean is the sum of two independent parts. In regression these parts are the deviation of the actual score from the predicted score, and the deviation of the predicted value from the grand mean.</p>
<p><span class="math display">\[\large Y_{i}-\bar{Y} = (Y_{i}-\hat{Y}_i) + (\hat{Y} - \bar{Y}_i)\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[\large Y_{i}-\bar{Y} = (Y_{i}-\hat{Y}_i) + (\hat{Y} - \bar{Y}_i)\]</span></p>
<p>In ANOVA, this holds true, but we express these relationships by referring to each Y within a group, and instead of “predicted value” we talk about group means. So now the parts are the deviation of the score from its group mean, and the deviation of that group mean from the grand mean. Why do we substitute “group mean” for “predicted value”?</p>
<p><span class="math display">\[\large Y_{ik}-\bar{Y} = (Y_{ik}-\bar{Y}_k) + (\bar{Y}_k - \bar{Y})\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[\large Y_{ik}-\bar{Y} = (Y_{ik}-\bar{Y}_k) + (\bar{Y}_k - \bar{Y})\]</span></p>
<p>In other words, each deviation score has a within-group part and a between-group part. These separate parts can be squared and summed, giving rise to two other sums of squares.</p>
</section>
<section class="slide level2">

<p>One part, the within-groups sum of squares, represents squared deviations of scores around the group means:</p>
<p><span class="math display">\[\large SS_w = \sum_{k=1}^G\sum_{i=1}^{N_k}(Y_{ik}-\bar{Y}_k)^2\]</span> The other, the between-groups sum of squares, represents deviations of the group means around the grand mean:</p>
<p><span class="math display">\[\large SS_b = \sum_{k=1}^GN_k(\bar{Y}_{k}-\bar{Y})^2\]</span></p>
<aside class="notes">
<p>How do these compare the sums of squares we are familiar with in regression?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<p>Sums of squares are central to ANOVA. They are the building blocks that represent different sources of variability in a research design. They are additive, meaning that the <span class="math inline">\(SS_{tot}\)</span> can be partitioned, or divided, into independent parts.</p>
<p>The total sum of squares is the sum of the between-groups sum of squares and the within-groups sum of squares.</p>
<p><span class="math display">\[\large SS_{tot} = SS_b + SS_w\]</span> The relative magnitude of sums of squares, especially in more complex designs, provides a way of identifying particularly large and important sources of variability.</p>
</section>
<section class="slide level2">

<p>If the null hypothesis is true, then variability among the means should be consistent with the variability of the data.</p>
<p>We know that relationship already: <span class="math display">\[\large \hat{\sigma}^2_{\bar{Y}} = \frac{\hat{\sigma}^2_{Y}}{N}\]</span> In other words, if we have an estimate of the variance of the means, we can transform that into an estimate of the variance of the scores, provided the only source of mean variability is sampling variability (the null hypothesis).</p>
<p><span class="math display">\[\large N\hat{\sigma}^2_{\bar{Y}} = \hat{\sigma}^2_Y\]</span></p>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p>The <span class="math inline">\(SS_w\)</span> is qualitatively giving us information that is similar to</p>
<p><span class="math display">\[\large \hat{\sigma}^2_Y\]</span></p>
</div><div class="column" style="width:50%;">
<p>The <span class="math inline">\(SS_b\)</span> is qualitatively giving us information that is similar to <span class="math display">\[\large N\hat{\sigma}^2_{\bar{Y}}\]</span></p>
</div>
</div>
<p>These are arrived at separately, but under the null hypothesis they should be estimates of the same thing. The only reason that <span class="math inline">\(SS_b\)</span> would be larger than expected is if there are systematic differences among the mean, perhaps created by experimental manipulations.</p>
<p>We need a formal way to make the comparison.</p>
</section>
<section class="slide level2">

<p>Because the sums of squares are numerators of variance estimates, we can divide each by their respective degrees of freedom to get variance estimates that, under the null hypothesis, should be approximately the same.</p>
<p>These variance estimates are known as mean squares:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\large MS_w = \frac{SS_w}{df_w}\]</span> <span class="math display">\[\large df_w = N-G\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\large MS_b = \frac{SS_b}{df_b}\]</span> <span class="math display">\[\large df_b = G-1\]</span></p>
</div>
</div>
<p>How are these degrees of freedom determined?</p>
</section>
<section class="slide level2">

<p>ANOVA assumes homogeneity of group variances. Under that assumption, the separate group variances are pooled to provide a single estimate of within-group variability.</p>
<p><span class="math display">\[\large SS_w = \sum_{k=1}^G\sum_{i=1}^{N_k}(Y_{ik}-\bar{Y}_k)^2 = \sum_{k=1}^G(N_k-1)\hat{\sigma}^2_k\]</span> The degrees of freedom are likewise pooled:</p>
<p><span class="math display">\[\large df_w = N-G=(N_1-1)+(N_2-1)+\dots+(N_G-1)\]</span> Where have we seen similar pooling?</p>
</section>
<section class="slide level2">

<p>If data are normally distributed, then the variance is <span class="math inline">\(\chi^2\)</span> distributed. The ratio of two <span class="math inline">\(\chi^2\)</span> distributed variables is F distributed.</p>
<p>In analysis of variance, the ratio of the mean squares (variance estimates) is symbolized by <span class="math inline">\(F\)</span> and has a sampling distribution that is <span class="math inline">\(F\)</span> distributed with degrees of freedom equal to <span class="math inline">\(df_b\)</span> and <span class="math inline">\(df_w\)</span>. That sampling distribution is used to determine if an obtained <span class="math inline">\(F\)</span> statistic is unusual enough to reject the null hypothesis.</p>
<p><span class="math display">\[\large F = \frac{MS_b}{MS_w}\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[\large F = \frac{MS_b}{MS_w}\]</span></p>
<p>If the null hypothesis is true, <span class="math inline">\(F\)</span> has an expected value of approximately 1.00 (the numerator and denominator are estimates of the same variability).</p>
<p>If the null hypothesis is false, the numerator will be larger than the denominator because systematic, between-group differences contribute to the variance of the means, but not to the variance within groups (ideally). If <span class="math inline">\(F\)</span> is “large enough,” we will reject the null hypothesis as a reasonable description of the obtained variability.</p>
</section>
<section class="slide level2">

<p>The <span class="math inline">\(F\)</span> statistic can be viewed as follows:</p>
<p><span class="math display">\[\large F = \frac{\hat{Q} + \hat{\sigma}^2}{\hat{\sigma}^2}\]</span></p>
<p>The extra term in the numerator (Q) is the treatment effect that, if present, increases variability among the means but does not affect the variability of scores within a group (treatment is a constant within any group).</p>
<p>As the treatment effect gets larger, the <span class="math inline">\(F\)</span> statistic departs from 1.00. If it departs enough, we claim F to be rare or unusual under the null and reject the null. The <span class="math inline">\(F\)</span> probability density distribution tells us how rare or unusual a particular <span class="math inline">\(F\)</span> statistic happens to be. The shape of the <span class="math inline">\(F\)</span> distribution is defined by its parameters, <span class="math inline">\(df_b\)</span> and <span class="math inline">\(df_w\)</span>.</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">data.frame</span>(<span class="at">F =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> F)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">196</span>), </span>
<span id="cb1-4"><a href="#cb1-4"></a>                <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">196</span>), </span>
<span id="cb1-6"><a href="#cb1-6"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">2.65</span>, <span class="dv">8</span>), <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fl">2.65</span>), <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Density"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="st">"F statistic"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="10-anova_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"><p><span class="math inline">\(F\)</span>-distributions are one-tailed tests. Recall that we’re interested in how far away our test statistic from the null <span class="math inline">\((F = 1).\)</span></p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>Participants performed an eye-hand coordination task while subjected to periodic 3-second bursts of 85 dB white noise played over earphones. The task required participants to keep a mouse pointer on a red dot that moved in a circular motion at a rate of 1 revolution per second. Participants performed the task until they allowed the pointer to stray from the rotating dot 10 times. The time (in seconds) at the 10th failure was recorded and is the outcome measure.</p>

<img data-src="images/dot.jpg" class="r-stretch"></section>
<section class="slide level2">

<h3 id="example-1">Example</h3>
<p>The participants were randomly assigned to one of four noise Groups:</p>
<ul>
<li class="fragment">controllable and predictable noise</li>
<li class="fragment">uncontrollable but predictable noise</li>
<li class="fragment">controllable but unpredictable noise</li>
<li class="fragment">uncontrollable and unpredictable noise.</li>
</ul>
<p>When noise was predictable, the 3-second bursts of noise would occur regularly every 20 seconds.</p>
<p>When noise was unpredictable, the 3-second bursts would occur randomly (although every 20 seconds on average).</p>
</section>
<section class="slide level2">

<p>When noise was uncontrollable, participants could do nothing to prevent the noise from occurring.</p>
<p>When noise was controllable, participants were shown a button that would prevent the noise, but they were told, “the button is a safety measure, for your protection, but we would prefer that you not use it unless absolutely necessary.” No participants actually used the button.</p>
<p>Why is it important that the button was never used?</p>
<p>Why is random assignment important in this design?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-2"><a href="#cb2-2"></a>rotate <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data/pursuit_rotor.csv"</span>))</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">head</span>(rotate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID Predict Control Group Time Gender
1  1       0       1     3  504      F
2  2       0       0     1  443      F
3  3       1       1     4  292      M
4  4       0       1     3  398      F
5  5       1       1     4  119      F
6  6       0       0     1  545      F</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">class</span>(rotate<span class="sc">$</span>Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>rotate<span class="sc">$</span>Group_lab <span class="ot">=</span> <span class="fu">factor</span>(rotate<span class="sc">$</span>Group, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control</span><span class="sc">\n</span><span class="st">Predict"</span>, </span>
<span id="cb6-3"><a href="#cb6-3"></a>                                     <span class="st">"No control</span><span class="sc">\n</span><span class="st">Predict"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>                                     <span class="st">"Control</span><span class="sc">\n</span><span class="st">Unpredict"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                                     <span class="st">"No control</span><span class="sc">\n</span><span class="st">Unpredict"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> rotate, <span class="at">x =</span> <span class="st">"Group_lab"</span>, <span class="at">y =</span> <span class="st">"Time"</span>, <span class="at">xlab =</span> F) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="10-anova_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><div class="fragment">
<p>The pattern of means indicates that performance degrades with either uncontrollable noise or unpredictable noise. Noise that is both uncontrollable and unpredictable appears to be particularly disruptive.</p>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggbarplot</span>(<span class="at">data =</span> rotate, <span class="at">x =</span> <span class="st">"Group_lab"</span>, <span class="at">y =</span> <span class="st">"Time"</span>, <span class="at">xlab =</span> F, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_ci"</span>), <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="10-anova_files/figure-revealjs/unnamed-chunk-5-1.png" width="1440" class="r-stretch"><p>Addition of the confidence intervals indicates that the two extreme Groups are likely different from all of the other Groups.</p>
</section>
<section class="slide level2">

<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb9-3"><a href="#cb9-3"></a>rotate <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">group_by</span>(Group_lab) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb9-6"><a href="#cb9-6"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(Time, <span class="at">na.rm =</span> T),</span>
<span id="cb9-7"><a href="#cb9-7"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(Time, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Group_lab </th>
   <th style="text-align:right;"> N </th>
   <th style="text-align:right;"> Mean </th>
   <th style="text-align:right;"> SD </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Control
Predict </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 542.04 </td>
   <td style="text-align:right;"> 57.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> No control
Predict </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> 352.85 </td>
   <td style="text-align:right;"> 67.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Control
Unpredict </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:right;"> 379.04 </td>
   <td style="text-align:right;"> 71.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> No control
Unpredict </td>
   <td style="text-align:right;"> 56 </td>
   <td style="text-align:right;"> 265.98 </td>
   <td style="text-align:right;"> 68.68 </td>
  </tr>
</tbody>
</table>

</div>
<p>The groups differ in their sample sizes, which can easily occur with free random assignment. There are advantages to equal sample sizes, so researchers often restrict random assignment to insure equal sample sizes across Groups.</p>
<p>Hard to tell if the variability in the four groups is homogeneous.</p>
</section>
<section id="run-the-anova-model" class="slide level2">
<h2>Run the ANOVA model</h2>
<div class="cell" data-output.lines="[1,2,3,4,5,6]">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>fit_1 <span class="ot">=</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Group_lab, <span class="at">data =</span> rotate)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">anova</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Analysis of Variance Table

Response: Time
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
Group_lab   3 2000252  666751  149.82 &lt; 0.00000000000000022 ***
Residuals 196  872288    4450                                  
...</code></pre>
</div>
</div>
<p>The <span class="math inline">\(F\)</span> statistic is highly unusual in the <span class="math inline">\(F\)</span> distribution, assuming the null hypothesis is true. We reject the null hypothesis.</p>
</section>
<section class="slide level2">

<p>Note: how does the output above compare to this output?</p>
<div class="cell" data-output.lines="[3,4,5,6]">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>fit_1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Group, <span class="at">data =</span> rotate)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">anova</span>(fit_1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Response: Time
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
Group       1 1613798 1613798  253.85 &lt; 0.00000000000000022 ***
Residuals 198 1258741    6357                                  
...</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>fit_1 <span class="ot">=</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Group_lab, <span class="at">data =</span> rotate)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">anova</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Time
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
Group_lab   3 2000252  666751  149.82 &lt; 0.00000000000000022 ***
Residuals 196  872288    4450                                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We know the means are not equal, but the particular source of the inequality is not revealed by the <span class="math inline">\(F\)</span> test.</p>
<p>One simple way to determine what is behind the significant <span class="math inline">\(F\)</span> test is to compare each Group to all other Groups.</p>
</section>
<section class="slide level2">

<p>These comparisons take the general form of t-tests, but note some extensions:</p>
<ul>
<li class="fragment">the pooled variance estimate comes from <span class="math inline">\(SS_{\text{residual}}\)</span>, meaning it pulls information from all groups</li>
<li class="fragment">the degrees of freedom for the <em>t</em>-test is <span class="math inline">\(N-k\)</span>, so using all data</li>
</ul>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">anova</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Time
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
Group_lab   3 2000252  666751  149.82 &lt; 0.00000000000000022 ***
Residuals 196  872288    4450                                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">

</div>
<p><span class="math inline">\(\hat{\sigma}_p = \sqrt{\frac{SS_{\text{residual}}}{N-k}} = \sqrt{\frac{872287.58}{200 - 4}} = 66.71\)</span></p>
</section>
<section class="slide level2">

<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Group_lab </th>
   <th style="text-align:right;"> N </th>
   <th style="text-align:right;"> Mean </th>
   <th style="text-align:right;"> SD </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Control
Predict </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 542.04 </td>
   <td style="text-align:right;"> 57.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> No control
Predict </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> 352.85 </td>
   <td style="text-align:right;"> 67.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Control
Unpredict </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:right;"> 379.04 </td>
   <td style="text-align:right;"> 71.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> No control
Unpredict </td>
   <td style="text-align:right;"> 56 </td>
   <td style="text-align:right;"> 265.98 </td>
   <td style="text-align:right;"> 68.68 </td>
  </tr>
</tbody>
</table>

</div>
<p>To test the pairwise comparison, we use the old formulas for the <a href="https://uopsych.github.io/psy611/lectures/16-independent_samples.html">independent samples <em>t</em>-test</a>, except with this estimate of pooled sd and DF based on total N.</p>
</section>
<section class="slide level2">

<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Group_lab </th>
   <th style="text-align:right;"> N </th>
   <th style="text-align:right;"> Mean </th>
   <th style="text-align:right;"> SD </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Control
Predict </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 542.04 </td>
   <td style="text-align:right;"> 57.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> No control
Predict </td>
   <td style="text-align:right;"> 52 </td>
   <td style="text-align:right;"> 352.85 </td>
   <td style="text-align:right;"> 67.98 </td>
  </tr>
</tbody>
</table>

</div>
<div class="cell">

</div>
<p><span class="math inline">\(\hat{\sigma}_p = \sqrt{\frac{SS_{\text{residual}}}{N-k}} = \sqrt{\frac{872287.58}{200 - 4}} = 66.71\)</span></p>
<p><span class="math inline">\(\sigma_{D} = \hat{\sigma}_p\sqrt{\frac{1}{N_1} + \frac{1}{N_2}} = 66.71 \sqrt{\frac{1}{47} + \frac{1}{52}} = 13.43\)</span></p>
<p><span class="math inline">\(t = \frac{M_1-M_2}{\sigma_D} = \frac{542.04 - 352.85 }{13.43} = 14.09\)</span></p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">emmeans</span>(fit_1, pairwise <span class="sc">~</span> Group_lab, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
  Group_lab            emmean   SE  df lower.CL upper.CL
 Control\nPredict         542 9.73 196      523      561
 No control\nPredict      353 9.25 196      335      371
 Control\nUnpredict       379 9.94 196      359      399
 No control\nUnpredict    266 8.91 196      248      284

Confidence level used: 0.95 

$contrasts
   contrast                                  estimate   SE  df t.ratio p.value
 Control\nPredict - No control\nPredict         189.2 13.4 196  14.091  &lt;.0001
 Control\nPredict - Control\nUnpredict          163.0 13.9 196  11.715  &lt;.0001
 Control\nPredict - No control\nUnpredict       276.1 13.2 196  20.918  &lt;.0001
 No control\nPredict - Control\nUnpredict       -26.2 13.6 196  -1.929  0.0552
 No control\nPredict - No control\nUnpredict     86.9 12.8 196   6.761  &lt;.0001
 Control\nUnpredict - No control\nUnpredict     113.1 13.4 196   8.466  &lt;.0001</code></pre>
</div>
</div>
</section>
<section id="family-wise-error" class="slide level2">
<h2>Family-wise error</h2>
<p>These pairwise comparisons can quickly grow in number as the number of Groups increases. With 4 (k) Groups, we have k(k-1)/2 = 6 possible pairwise comparisons.</p>
<p>As the number of groups in the ANOVA grows, the number of possible pairwise comparisons increases dramatically.</p>

<img data-src="10-anova_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>As the number of tests grows, and assuming the null hypothesis is true, the probability that we will make one or more Type I errors increases. To approximate the magnitude of the problem, we can assume that the multiple pairwise comparisons are independent. The probability that we <strong>don’t</strong> make a Type I error for one test is:</p>
<p><span class="math display">\[P(\text{No Type I}, 1 \text{ test}) = 1-\alpha\]</span></p>
</section>
<section class="slide level2">

<p>The probability that we don’t make a Type I error for two tests is:</p>
<p><span class="math display">\[P(\text{No Type I}, 2 \text{ test}) = (1-\alpha)(1-\alpha)\]</span></p>
<p>For C tests, the probability that we make <strong>no</strong> Type I errors is</p>
<p><span class="math display">\[P(\text{No Type I}, C \text{ tests}) = (1-\alpha)^C\]</span></p>
<p>We can then use the following to calculate the probability that we make one or more Type I errors in a collection of C independent tests.</p>
<p><span class="math display">\[P(\text{At least one Type I}, C \text{ tests}) = 1-(1-\alpha)^C\]</span></p>
</section>
<section class="slide level2">

<p>The Type I error inflation that accompanies multiple comparisons motivates the large number of “correction” procedures that have been developed.</p>

<img data-src="10-anova_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Multiple comparisons, each tested with <span class="math inline">\(\alpha_{per-test}\)</span>, increases the family-wise <span class="math inline">\(\alpha\)</span> level.</p>
<p><span class="math display">\[\large \alpha_{family-wise} = 1 - (1-\alpha_{per-test})^C\]</span> Šidák showed that the family-wise a could be controlled to a desired level (e.g., .05) by changing the <span class="math inline">\(\alpha_{per-test}\)</span> to:</p>
<p><span class="math display">\[\large \alpha_{per-wise} = 1 - (1-\alpha_{family-wise})^{\frac{1}{C}}\]</span></p>
</section>
<section class="slide level2">

<h3 id="bonferroni">Bonferroni</h3>
<p>Bonferroni (and Dunn, and others) suggested this simple approximation:</p>
<p><span class="math display">\[\large \alpha_{per-test} = \frac{\alpha_{family-wise}}{C}\]</span></p>
<p>This is typically called the Bonferroni correction and is very often used even though better alternatives are available.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">emmeans</span>(fit_1, pairwise <span class="sc">~</span> Group_lab, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
  Group_lab            emmean   SE  df lower.CL upper.CL
 Control\nPredict         542 9.73 196      523      561
 No control\nPredict      353 9.25 196      335      371
 Control\nUnpredict       379 9.94 196      359      399
 No control\nUnpredict    266 8.91 196      248      284

Confidence level used: 0.95 

$contrasts
   contrast                                  estimate   SE  df t.ratio p.value
 Control\nPredict - No control\nPredict         189.2 13.4 196  14.091  &lt;.0001
 Control\nPredict - Control\nUnpredict          163.0 13.9 196  11.715  &lt;.0001
 Control\nPredict - No control\nUnpredict       276.1 13.2 196  20.918  &lt;.0001
 No control\nPredict - Control\nUnpredict       -26.2 13.6 196  -1.929  0.3312
 No control\nPredict - No control\nUnpredict     86.9 12.8 196   6.761  &lt;.0001
 Control\nUnpredict - No control\nUnpredict     113.1 13.4 196   8.466  &lt;.0001

P value adjustment: bonferroni method for 6 tests </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>The Bonferroni procedure is conservative. Other correction procedures have been developed that control family-wise Type I error at .05 but that are more powerful than the Bonferroni procedure. The most common one is the Holm procedure.</p>
<p>The Holm procedure does not make a constant adjustment to each per-test <span class="math inline">\(\alpha\)</span>. Instead it makes adjustments in stages depending on the relative size of each pairwise p-value.</p>
</section>
<section class="slide level2">

<h3 id="holm-correction">Holm correction</h3>
<ol type="1">
<li class="fragment">Rank order the p-values from largest to smallest.</li>
<li class="fragment">Start with the smallest p-value. Multiply it by its rank.</li>
<li class="fragment">Go to the next smallest p-value. Multiply it by its rank. If the result is larger than the adjusted p-value of next smallest rank, keep it. Otherwise replace with the previous step adjusted p-value.</li>
<li class="fragment">Repeat Step 3 for the remaining p-values.</li>
<li class="fragment">Judge significance of each new p-value against <span class="math inline">\(\alpha = .05\)</span>.</li>
</ol>
</section>
<section class="slide level2">

<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> Original p value </th>
   <th style="text-align:right;"> Rank </th>
   <th style="text-align:right;"> Rank x p </th>
   <th style="text-align:right;"> Holm </th>
   <th style="text-align:right;"> Bonferroni </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0.0072 </td>
   <td style="text-align:right;"> 0.0072 </td>
   <td style="text-align:right;"> 0.0072 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.0023 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0.0115 </td>
   <td style="text-align:right;"> 0.0115 </td>
   <td style="text-align:right;"> 0.0138 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.0450 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0.1800 </td>
   <td style="text-align:right;"> 0.1800 </td>
   <td style="text-align:right;"> 0.2700 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.0470 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.1410 </td>
   <td style="text-align:right;"> 0.1800 </td>
   <td style="text-align:right;"> 0.2820 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.0530 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.1060 </td>
   <td style="text-align:right;"> 0.1800 </td>
   <td style="text-align:right;"> 0.3180 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.2100 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.2100 </td>
   <td style="text-align:right;"> 0.2100 </td>
   <td style="text-align:right;"> 1.0000 </td>
  </tr>
</tbody>
</table>

</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">emmeans</span>(fit_1, pairwise <span class="sc">~</span> Group_lab, <span class="at">adjust =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
  Group_lab            emmean   SE  df lower.CL upper.CL
 Control\nPredict         542 9.73 196      523      561
 No control\nPredict      353 9.25 196      335      371
 Control\nUnpredict       379 9.94 196      359      399
 No control\nUnpredict    266 8.91 196      248      284

Confidence level used: 0.95 

$contrasts
   contrast                                  estimate   SE  df t.ratio p.value
 Control\nPredict - No control\nPredict         189.2 13.4 196  14.091  &lt;.0001
 Control\nPredict - Control\nUnpredict          163.0 13.9 196  11.715  &lt;.0001
 Control\nPredict - No control\nUnpredict       276.1 13.2 196  20.918  &lt;.0001
 No control\nPredict - Control\nUnpredict       -26.2 13.6 196  -1.929  0.0552
 No control\nPredict - No control\nUnpredict     86.9 12.8 196   6.761  &lt;.0001
 Control\nUnpredict - No control\nUnpredict     113.1 13.4 196   8.466  &lt;.0001

P value adjustment: holm method for 6 tests </code></pre>
</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="anova-is-regression" class="title-slide slide level1 center">
<h1>ANOVA is regression</h1>
<p>We saw in the previous lecture that we can accommodate categorical variables into a regression model. How does this compare to ANOVA?</p>
<ul>
<li class="fragment">Same omnibus test of the model!</li>
</ul>
<p>*(Really the same model, but packaged differently.)</p>
<ul>
<li class="fragment">When would you use one versus the other?</li>
</ul>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><strong>ANOVA</strong></p>
<ul>
<li class="fragment"><p>More traditional for 3+ groups</p></li>
<li class="fragment"><p>Comparing/controlling multiple categorical variables</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Regression</strong></p>
<ul>
<li class="fragment"><p>Best for two groups</p></li>
<li class="fragment"><p>Incorporating continuous predictors too</p></li>
<li class="fragment"><p>Good for 3+ groups when you have more specific hypotheses (contrasts)</p></li>
</ul>
</div>
</div>
</section>
<section class="slide level2">

<p>One benefit to using the ANOVA framework instead of the regression framework is that you can estimate the total variability captured by one categorical variable controlling for another categorical or continuous variable with ease.</p>
<p><span class="math inline">\(\eta^2\)</span> (eta-squared) is a standardized measure of effect size used in analyses of variance. This effect size is the <strong>proportion of variance in Y that is accounted for by one independent variable.</strong></p>
<p><span class="math display">\[\eta^2 = \frac{SS_{variable}}{SS_{total}}\]</span></p>
<p>For example, what if we believed gender was associated with performance on the noise burst task.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>mod2 <span class="ot">=</span> <span class="fu">aov</span>(Time <span class="sc">~</span> Group_lab <span class="sc">+</span> Gender, <span class="at">data =</span> rotate)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">anova</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Time
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
Group_lab   3 2000252  666751 160.853 &lt; 0.00000000000000022 ***
Gender      1   63993   63993  15.438             0.0001183 ***
Residuals 195  808294    4145                                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>lsr<span class="sc">::</span><span class="fu">etaSquared</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              eta.sq eta.sq.part
Group_lab 0.62526817   0.6896430
Gender    0.02227757   0.0733625</code></pre>
</div>
</div>
</section>
<section id="contrasts" class="slide level2">
<h2>Contrasts</h2>
<p>Recall from the previous lecture that dummy codes are series of 1’s and 0’s with one group established as the reference group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">base =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1 2 4
1 1 0 0
2 0 1 0
3 0 0 0
4 0 0 1</code></pre>
</div>
</div>
<div class="cell" data-output.lines="[9,10,11,12,13,14]">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">contrasts</span>(rotate<span class="sc">$</span>Group_lab) <span class="ot">=</span> <span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">base =</span> <span class="dv">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Time <span class="sc">~</span> Group_lab, <span class="at">data =</span> rotate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  379.044      9.945  38.115 &lt; 0.0000000000000002 ***
Group_lab1   162.998     13.914  11.715 &lt; 0.0000000000000002 ***
Group_lab2   -26.198     13.583  -1.929               0.0552 .  
Group_lab4  -113.062     13.356  -8.466  0.00000000000000592 ***
...</code></pre>
</div>
</div>
</section>
<section id="contrasts-1" class="slide level2">
<h2>Contrasts</h2>
<p>But there’s more you can do!</p>
<p>You’re not restricted to simple dummy coding. Choosing another variant of contrast codes allows you to test more specific hypotheses. There are some common coding schemes.</p>
</section>
<section class="slide level2">

<p>For example, <strong>deviation coding</strong> (sometimes called <strong>“effect coding”</strong>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">contr.sum</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1] [,2] [,3]
1    1    0    0
2    0    1    0
3    0    0    1
4   -1   -1   -1</code></pre>
</div>
</div>
<div class="cell" data-output.lines="[9,10,11,12,13,14]">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">contrasts</span>(rotate<span class="sc">$</span>Group_lab) <span class="ot">=</span> <span class="fu">contr.sum</span>(<span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Time<span class="sc">~</span>Group_lab, <span class="at">data =</span> rotate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  384.979      4.734  81.314 &lt; 0.0000000000000002 ***
Group_lab1   157.064      8.352  18.805 &lt; 0.0000000000000002 ***
Group_lab2   -32.133      8.075  -3.979            0.0000973 ***
Group_lab3    -5.934      8.477  -0.700                0.485    
...</code></pre>
</div>
</div>
</section>
<section id="contrasts-2" class="slide level2">
<h2>Contrasts</h2>
<p>You can create a contrast matrix that tests any number of hypotheses, like whether groups 1 and 3 are different from group 4. The rules for setting up contrast codes are:</p>
<ol type="1">
<li class="fragment"><p>The sum of the weights across all groups for each code variable must equal 0. (Sum down the column = 0).</p></li>
<li class="fragment"><p>The sum of the product of each pair of code variables, <span class="math inline">\(C_1C_2,\)</span> must equal 0. (This is challenging when your groups are unequal sizes).</p></li>
<li class="fragment"><p>The difference between the value of the set of positive weights and the set of negative weights should equal 1 for each code variable (column).</p></li>
</ol>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">contrasts</span>(rotate<span class="sc">$</span>Group_lab) <span class="ot">=</span> <span class="fu">contr.treatment</span>(<span class="dv">4</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb36-3"><a href="#cb36-3"></a>Lmatrix <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">c</span>( <span class="dv">0</span>,   <span class="dv">1</span>,   <span class="sc">-</span><span class="dv">1</span>,    <span class="dv">0</span>,  <span class="co"># G2 vs G3</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,   <span class="dv">0</span>,   <span class="sc">-</span><span class="dv">1</span>,  <span class="co"># G1/G2 vs G4</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="co"># G1/G2 vs G3/G4</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,  <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,  <span class="sc">-</span><span class="dv">1</span>), <span class="co"># G1/G2/G3 vs G4</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> T)</span>
<span id="cb36-9"><a href="#cb36-9"></a>mod <span class="ot">=</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Group_lab, <span class="at">data =</span> rotate)</span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="fu">summary</span>(<span class="fu">glht</span>(mod, </span>
<span id="cb36-11"><a href="#cb36-11"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Group_lab =</span> Lmatrix)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: lm(formula = Time ~ Group_lab, data = rotate)

Linear Hypotheses:
       Estimate Std. Error t value Pr(&gt;|t|)    
1 == 0  -26.198     13.583  -1.929    0.137    
2 == 0  181.462     11.160  16.260   &lt;0.001 ***
3 == 0  124.931      9.469  13.194   &lt;0.001 ***
4 == 0  158.662     10.512  15.094   &lt;0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
</section>
<section id="next-time" class="slide level2">
<h2>Next time…</h2>
<p>Assumptions and diagnostics</p>
<div class="footer footer-default">

</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="10-anova_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="10-anova_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="10-anova_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="10-anova_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"4295152c006e72b2","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>